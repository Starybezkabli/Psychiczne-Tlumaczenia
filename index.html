<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Psychiczne t≈Çumaczenia</title>

<!-- React CDN ‚Äî GitHub safe -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
body{
margin:0;
font-family:system-ui,sans-serif;
background:linear-gradient(#120022,#000);
color:#e9d5ff;
}

header{
background:#2e1065;
padding:12px;
position:sticky;
top:0;
z-index:10;
}

.subbar{
background:#1a0033;
padding:8px;
border-top:1px solid #5b21b6;
}

input,textarea,select{
width:100%;
background:#1a0033;
border:1px solid #5b21b6;
color:white;
padding:8px;
border-radius:6px;
margin-bottom:6px;
}

button{
background:#6d28d9;
border:none;
padding:8px 12px;
border-radius:6px;
color:white;
cursor:pointer;
margin:2px;
}
button:hover{background:#7c3aed;}

.card{
background:#1a0033;
border:1px solid #5b21b6;
padding:12px;
border-radius:10px;
margin-bottom:12px;
}

.grid{
display:grid;
grid-template-columns:repeat(auto-fill,minmax(220px,1fr));
gap:12px;
}

.tag{
display:inline-block;
background:#3b0764;
padding:4px 8px;
border-radius:999px;
margin:2px;
font-size:12px;
cursor:pointer;
}

.reader img{
width:100%;
display:block;
margin-bottom:6px;
border-radius:8px;
}
</style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">

/* ========= CONSTANTS ========= */
const TAGS=[
"yaoi","yuri","hetero","romans","akcja","kryminalne","horror","krwawe","wampiry","inny ≈õwiat","fantasy","wilko≈Çaki","dziewczyny","ch≈Çopcy","przyjaciele z dzieci≈Ñstwa","rodzina kr√≥lewska","psychologiczne","kosmici","szkolne","policja","historyczne","slice of life","omegaverse","wojna","walki","morderstwa","lochy","potwory","magiczne","auta","wy≈õcigi","drama","r√≥≈ºnica wieku","demon y","anio≈Çy","zagadki","ninja","zmiana cia≈Ç","komedia","duchy","dzieci","dla doros≈Çych","medyczne","sm/bdsm/sub-dom","gry wideo","muzyka","konkurencje","wr√≥≈ºki","fetysze","zemsta","klƒÖtwy"
];

const TYPES=["manhwa","manga","manhua","novelka","webtoon","one shot"];

const uid=()=>Date.now()+Math.random();
const load=(k,d)=>JSON.parse(localStorage.getItem(k)||JSON.stringify(d));
const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));

/* ========= APP ========= */
function App(){

const [series,setSeries]=React.useState(load("series",[]));
const [user,setUser]=React.useState(load("user",null));
const [view,setView]=React.useState("home");
const [active,setActive]=React.useState(null);
const [query,setQuery]=React.useState("");
const [menu,setMenu]=React.useState(false);

React.useEffect(()=>save("series",series),[series]);
React.useEffect(()=>save("user",user),[user]);

const filtered=series.filter(s=>
(s.title||"").toLowerCase().includes(query.toLowerCase())||
(s.tags||[]).some(t=>t.toLowerCase().includes(query.toLowerCase()))
);

return(
<div>

<header>
<div style={{display:"flex",gap:8,alignItems:"center",flexWrap:"wrap"}}>
<b style={{fontSize:20,cursor:"pointer"}} onClick={()=>setView("home")}>Psychiczne t≈Çumaczenia</b>

<input placeholder="Szukaj‚Ä¶" value={query} onChange={e=>setQuery(e.target.value)}/>

<button onClick={()=>setMenu(!menu)}>‚ò∞</button>

{user
? <button onClick={()=>setUser(null)}>Wyloguj ({user})</button>
: <button onClick={()=>setView("login")}>Login</button>}

<button onClick={()=>setView("admin")}>Panel</button>
</div>

<div className="subbar">
{TYPES.map(t=><span key={t} className="tag">{t}</span>)}
</div>

{menu&&(
<div className="card">
{series.map(s=>
<div key={s.id} style={{cursor:"pointer"}}
onClick={()=>{setActive(s);setView("series");setMenu(false);}}>
{s.title}
</div>
)}
</div>
)}

</header>

<div style={{padding:12}}>

{view==="home"&&<Home series={filtered} open={s=>{setActive(s);setView("series");}}/>}

{view==="series"&&active&&
<Series data={active} user={user}
update={u=>{
setSeries(series.map(s=>s.id===u.id?u:s));
setActive(u);
}}/>}

{view==="admin"&&<Admin add={s=>setSeries([...series,s])}/>}

{view==="login"&&<Login setUser={setUser}/>}

</div>
</div>
);
}

/* ========= HOME ========= */
function Home({series,open}){
return(
<div className="grid">
{series.map(s=>
<div key={s.id} className="card" onClick={()=>open(s)}>
<b>{s.title}</b>
<div>{(s.tags||[]).map(t=><span key={t} className="tag">{t}</span>)}</div>
</div>
)}
</div>
);
}

/* ========= SERIES ========= */
function Series({data,update,user}){

const [ctitle,setCtitle]=React.useState("");
const [cimages,setCimages]=React.useState([]);
const [comment,setComment]=React.useState("");

function upload(e){
const files=[...e.target.files];
Promise.all(files.map(f=>new Promise(res=>{
const r=new FileReader();
r.onload=()=>res(r.result);
r.readAsDataURL(f);
}))).then(imgs=>setCimages(imgs));
}

function addChapter(){
if(!ctitle)return;
update({
...data,
chapters:[...(data.chapters||[]),
{id:uid(),title:ctitle,images:cimages,comments:[],rating:0}]
});
setCtitle("");
setCimages([]);
}

function addComment(id){
if(!user||!comment)return;
update({
...data,
chapters:data.chapters.map(c=>
c.id===id
?{...c,comments:[...c.comments,{user,text:comment}]}
:c
)
});
setComment("");
}

function rate(id){
update({
...data,
chapters:data.chapters.map(c=>
c.id===id?{...c,rating:c.rating+1}:c
)
});
}

return(
<div>

<div className="card">
<h2>{data.title}</h2>
<p>{data.description}</p>
</div>

<div className="card">
<h3>Dodaj rozdzia≈Ç</h3>
<input placeholder="Tytu≈Ç" value={ctitle} onChange={e=>setCtitle(e.target.value)}/>
<input type="file" multiple accept="image/*" onChange={upload}/>
<button onClick={addChapter}>Dodaj</button>
</div>

{(data.chapters||[]).map(ch=>
<div key={ch.id} className="card">
<b>{ch.title}</b>
<div className="reader">
{ch.images.map((img,i)=><img key={i} src={img}/>) }
</div>
<button onClick={()=>rate(ch.id)}>üëç {ch.rating}</button>

<h4>Komentarze</h4>
{ch.comments.map((c,i)=><div key={i}><b>{c.user}:</b> {c.text}</div>)}

<input placeholder="Komentarz" value={comment} onChange={e=>setComment(e.target.value)}/>
<button onClick={()=>addComment(ch.id)}>Dodaj</button>

</div>
)}

</div>
);
}

/* ========= ADMIN ========= */
function Admin({add}){

const [title,setTitle]=React.useState("");
const [desc,setDesc]=React.useState("");
const [tags,setTags]=React.useState([]);
const [type,setType]=React.useState(TYPES[0]);

function create(){
if(!title)return;
add({id:uid(),title,description:desc,type,tags,chapters:[]});
setTitle("");setDesc("");setTags([]);
}

return(
<div className="card">
<h3>Dodaj seriƒô</h3>
<input placeholder="Tytu≈Ç" value={title} onChange={e=>setTitle(e.target.value)}/>
<textarea placeholder="Opis" value={desc} onChange={e=>setDesc(e.target.value)}/>

<select value={type} onChange={e=>setType(e.target.value)}>
{TYPES.map(t=><option key={t}>{t}</option>)}
</select>

<div>
{TAGS.map(t=>
<span key={t} className="tag"
style={{background:tags.includes(t)?"#9333ea":"#3b0764"}}
onClick={()=>setTags(tags.includes(t)?tags.filter(x=>x!==t):[...tags,t])}>
{t}
</span>
)}
</div>

<button onClick={create}>Dodaj seriƒô</button>
</div>
);
}

/* ========= LOGIN ========= */
function Login({setUser}){
const [name,setName]=React.useState("");
return(
<div className="card">
<input placeholder="Nick" value={name} onChange={e=>setName(e.target.value)}/>
<button onClick={()=>setUser(name)}>Wejd≈∫</button>
</div>
);
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);

</script>
</body>
</html>
